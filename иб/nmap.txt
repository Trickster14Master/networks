open (открыт) =	Приложение принимает на порт пакет или запросы на соединение
closed (закрыт) = Порт отвечает на запросы, но не используется ни каким приложением
filtered (фильтруется) = Запросы не доходят до этого порта, а значит невозможно определить открыт он или нет
unfiltered (не фильтруется) = Порт доступен, но Nmap не может определить закрыт он или открыт. Как правило помогает использование другого способа сканирования
open|filtered (открыт|фильтруется) = Не получается определить открыт порт или фильтруется. Возникает если открытый порт не отвечает. Как правило помогает использование другого способа сканирования
closed|filtered (закрыт|фильтруется) = Не получается определить закрыт порт или фильтруется. Как правило помогает использование другого способа сканирования
"""

frequently_used"""
!обноружение хостов!
*nmap -sL 192.168.1.1/24 = вывод всех ip дресов сети
nmap -sn 192.168.1.1/24 = просконировать ip дреса и вывисти их адреса 
*nmap -sP 192.168.1.1/24 = вывод всех ip и mac адресов участников сети 
*nmap -PN 192.168.1.1/24 = Запустить пинг сканирование
*nmap -Pn 192.168.1.1/24 = принудительный скан портов 
*nmap -PS / -PA / -PU = олучение списков портов, -PS - TCPSYN,  -PA TCPASC (юзать если есть Firewall), -PU UDP пингование 
nmap -PO 192.168.1.1/24 = Команда для получения списка протоколов пингованием с использованием IP протокола (для запуска необходим root). В этом случае должны приходить ответы по протоколу указанному в запросе, это означает что протокол активен, если приходит ответ что хост не достижим, это даёт понят, что протокол не поддерживается.
nmap -sP --traceroute = позволяющая выполнить трасировку т.е. отследить путь к хосту, она применяется вместе с любым видом сканирования и работает на основании данных полученных в результате него
nmap -A 192.168.1.1/24 = определить операционную систему 

!сканирование портов!
nmap -sS хост = TCP SYN сканирование, SYN/ACK – значит порт открыт, RST – значит закрыт
*nmap -sU хост = UDP сканирование, указаниен конкретного порта  -p U:53
nmap -sA хост = TCP ACK сканирование которое используется для определения правил брандмауэров и фильтруемых ими портов
nmap -sO хост = Сканирование IP протокола, таким способом можно определить какие IP протоколы поддерживаются целью.

!Определение портов и порядка сканирования!
-p = Для того чтобы вручную выбрать порты или диапазон портов для сканирования, используется параметр.
-F = прсканировать 100 самых популятных портов 
-p- = просканировать все порты 
сканирование по TCP = T:
сканирование по UDP = U:
пример 
*nmap -sS -sU -p 22,80,111,U:53,137 scanme.nmap.org
nmap --reason 192.168.1.1/24 = опредеоить по какой пречине тели или иные весщи происходят с портом 
nmap --open 192.168.1.1/24 = вывод только открытых портов 
nmap --packet-trase = информация о переданных и полученных пакетах 


!Определение служб, их версий и операционной системы!
nmap -sS -sV хост = Определение версий
nmap -O хост = определение операционной системы 

!Обход брандмауэров / IDS!
nmap -f = фрагментация пакетов.
nmap -D хост,хост,хост хост_жертва = сканирование с использованием фиктивных хостов.
nmap --data-length 32 = добовляем к пакету указонное количество байт 
nmap --spoof-mac 0 = подмена mac адреса 

!сохранение в файл!
nmap -oN имя файла = сахранение данных в файле, таким образом которым они выглядет в терменале 
nmap -oX имя файла = сохраняет в виде удобным для последующей оброботки другими программами 
nmap -oG имя файла = данные каждого хоста будут выведены в отдельную строчку 

!скрипты nmap!
Категории скриптов Nmap:
auth = Категория скриптов которая работает с учетными данными аутентификации на исследуемой системе
broadcast = Эти скрипты нужны для обнаружения хостов не перечисленных в командной строке, путем широковещательной передачи в локальной сети. При использовании аргумента newtargets, найденные хосты будут автоматически добавляться в очередь на сканирование
brute = Скрипты для проведения brute force атак с целью получения учётных данных аутентификации.
default = Базовый набор скриптов, определенных разработчиками как “скрипты по умолчанию” для расширения функционала Nmap. Именно они запускаются командой -sC или -A
discovery = Скрипты этой категории собирают учетные, регистрационные и статистические данные о исследуемой системе
dos = Эти скрипты проверяют исследуемую систему на уязвимости к атакам методом отказа в обслуживании
exploit = Nmap попытается эксплуатировать некоторые известные уязвимости
external = Эти скрипты отправляют информацию в сторонние базы данных или ресурсы, например: whois, virus total, robtex, geoplugin, ipinfo ну и т.д. для получения дополнительных данных о исследуемой цели
fuzzer = Скрипты для отправки программному обеспечению сервера неожиданных или рандомизированных полей в каждом пакете. Как правило используется для выявления уязвимостей или ошибок в настройках. Это достаточно агрессивные скрипты, использование которых может повлечь сбои в работе сервера
intrusive = В этой категории находятся наиболее агрессивные скрипты, направленные на выявление многих распространённых уязвимостей, как служб и сервисов, так и аудита паролей. Использование скриптов этой категории оставляет достаточно много следов в целевой системе и, как правило будет расценено администраторами как попытка несанкционированного вмешательства
malware = Эти скрипты проверяют целевую систему на предмет заражения вредоносным ПО и наличия бекдоров.
safe = Скрипты из этой категории предназначены для сбора общей информации и исследования сети, они не выполняют активных действий направленных на выявление или эксплуатацию уязвимостей, не подразумевают негативных последствий для работоспособности целевой системы
version = Это скрипты расширения функционала опции определения версий, их нельзя запустить отдельно, они срабатывают по мере необходимости при выборе параметра определения версий (-sV)
vuln = Скрипты проверяющие наличие известных уязвимостей, результаты будут показаны только в случае их обнаружения

Использование скриптов Nmap
как правило идёт в связке с сконирование портов 

*nmap -sS -sC 198.168.1.1 - cканирование на основе скриптов 
nmap --script default,safe, whois-domain 198.168.1.1 - запускает связку скриптов (default,safe), и отдельно взятый скрипт whois-domain
nmap --script-args  198.168.1.1
nmap -p 3306 --script mysql-audit --script-args mysql-audit.username='nselib/data/usernames.lst',mysql-audit.password='nselib/data/passwords.lst',mysql-audit.filename='nselib/data/mysql-cis.audit' no-jus.com - запускает проверку на 3306 порт, запускает sql проверку, а передаём в аргументы типичтое амена и пароли пользователя (брут)